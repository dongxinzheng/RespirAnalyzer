MovingAverage<-function(y,W){
  N <- length(y)
  index <- floor(W/2)
  shuchu <- vector(length=N)
  for (i in 1:index){
    shuchu[i] <- mean(y[1:i])
  }
  for (i in (index+1):(N-index)){
    shuchu[i] <- mean(y[(i-index):(i+index)])
  }
  for(i in (N-index+1):N){
    shuchu[i] <- mean(y[i:N])
  }
  return(shuchu)
}
